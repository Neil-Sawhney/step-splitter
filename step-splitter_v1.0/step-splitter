#!/bin/bash

# Check if the correct number of arguments is provided
if [ "$#" -ne 1 ]; then
    echo "Usage: $0 <step-file>"
    exit 1
fi

# Assign the argument to a variable
STEP_FILE="$1"

# Check if the file exists
if [ ! -f "$STEP_FILE" ]; then
    echo "Error: File '$STEP_FILE' not found."
    exit 1
fi

# Determine the directory where this script is located
SCRIPT_DIR="$(cd "$(dirname "${BASH_SOURCE[0]}")" && pwd)"

# Check if the step-splitter.py exists in the same directory
SPLITTER_SCRIPT="$SCRIPT_DIR/step-splitter.py"

if [ ! -f "$SPLITTER_SCRIPT" ]; then
    echo "Error: File 'step-splitter.py' not found in the script directory."
    exit 1
fi

echo "$STEP_FILE" | freecadcmd "$SPLITTER_SCRIPT"
